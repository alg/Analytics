#frontal
  .row
    -if defined?(@election) && @election.id.to_s == params[:id]
      .span2#redelecname
        = @election.name
        %br
        = @election.date
    -else
      .span2#redelecname
        No election event selected.
    .span10
      %table{:style=>"width:100%;"}
        %tr#statebar
          %td{:style=>"width:25%;"}
            Select
          %td{:style=>"width:25%;"}
            Add Logs
          %td{:style=>"width:25%;"}
            Add Voters
          %td#doing{:style=>"width:25%;"}
            Analyze
      %hr
  .row
    .span2.sidebar
      Textual description of report here.
    .span10
      .row
        .span7
          #likeh2blue Voter Outcome Report
        -if defined?(@election) && @election.id.to_s == params[:id]
          .span2#likeh4
            = link_to "Save as PDF", '/analytic_report.pdf?rn=2;id='+params[:id]
        .span1#statebacknext
          = link_to 'Back', :back
      .row
        .span10
          -if defined?(@election) && @election.id.to_s == params[:id]
            %span
              #likeh4b Scope
              %table
                %tr
                  %td= 'Election:'
                  %td= @election.name
                %tr
                  %td= 'Election Date:'
                  %td= @election.date
                %tr
                  %td= 'Reporting Period:'
                  %td
                    = @election.voter_start_day.strftime("%B %-d, %Y")
                    = "&ndash;".html_safe
                    = @election.voter_end_day.strftime("%B %-d, %Y")
                %tr
                  %td= 'Voter Population:'
                  %td= number_with_delimiter(@tv)+" Registered Voters"
              #likeh4b Summary
              %p 
                This report summarizes the full record of the transactions of
                all voters during the reporting period for the
                = @election.name
                = (@election.name =~ /election/i ? "" : ' Election')
                held on 
                = @election.date+"."
                The reported statistics cover a variety of
                %i voter participation outcomes,
                for example, voters who updated their voter record
                successfully before the election, voted absentee, and had
                their ballot counted.  
              %p 
                The statistics cover all such requests, both those made with
                or without the assistance of online services such as online
                registration assistance, or online marking and downloading of
                absentee ballots for printing, signing, and postal return to
                election officials.  
              %p 
                There are several voter classes reported, some with subtle but
                important distinctions about their activity in the reporting
                period:  
                %ul
                  %li
                    Voters who did not attempt any changes to their voter
                    record, and did not make an absentee ballot request,
                    including UOCAVA voters with pre-existing absentee status
                    that was unchanged. 
                  %li
                    Voters who successfully updated their voter record,
                    possibly with other voter record requests that were
                    rejected.  
                  %li
                    Voters who made one or more unsuccessful record update
                    requests, and were unable to update their record. 
                  %li
                    Voters who successfully requested an absentee ballot
                    = "&ndash;".html_safe
                    and UOCAVA voters who updated their absentee status
                    = "&ndash;".html_safe
                    possibly with other absentee requests that were rejected. 
                  %li
                    Voters who made one or more unsuccessful absentee
                    requests, and were unable to vote absentee.

              #likeh4b Outcomes
              %table
                %tr
                  %td= number_with_delimiter(@vnoruar['tot'])
                  %td{:style=>"text-align:right;"}
                    = "&mdash;".html_safe
                  %td Voters who did not request a record update or absentee ballot
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vnoruar['vno'])
                  %td Did not participate
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vnoruar['vpb'])
                  %td Voted in person
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vnoruar['vpa'])
                  %td Voted provisionally, ballot accepted
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vnoruar['vpr'])
                  %td Voted provisionally, ballot rejected
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vnoruar['vaa'])
                  %td Voted absentee, ballot accepted
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vnoruar['vrul'])
                  %td Voted absentee, ballot rejected as late
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vnoruar['vruo'])
                  %td Voted absentee, ballot rejected for other reason
                %tr{:style=>"line-height:10px;"}
                  %td{:colspan=>5} &nbsp;
                %tr
                  %td= number_with_delimiter(@vruappr['tot'])
                  %td{:style=>"text-align:right;"}
                    = "&mdash;".html_safe
                  %td Voters whose record update requests were approved
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vruappr['vno'])
                  %td Did not participate
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vruappr['vpb'])
                  %td Voted in person
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vruappr['vpa'])
                  %td Voted provisionally, ballot accepted
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vruappr['vpr'])
                  %td Voted provisionally, ballot rejected
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vruappr['vaa'])
                  %td Voted absentee, ballot accepted
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vruappr['vrul'])
                  %td Voted absentee, ballot rejected as late
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vruappr['vruo'])
                  %td Voted absentee, ballot rejected for other reason
                %tr{:style=>"line-height:10px;"}
                  %td{:colspan=>5} &nbsp;
                %tr
                  %td= number_with_delimiter(@vrufail['tot'])
                  %td{:style=>"text-align:right;"}
                    = "&mdash;".html_safe
                  %td Voters whose record update requests were ultimately unsuccessful
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vrufail['vno'])
                  %td Did not participate
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vrufail['vpb'])
                  %td Voted in person
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vrufail['vpa'])
                  %td Voted provisionally, ballot accepted
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vrufail['vpr'])
                  %td Voted provisionally, ballot rejected
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vrufail['vaa'])
                  %td Voted absentee, ballot accepted
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vrufail['vrul'])
                  %td Voted absentee, ballot rejected as late
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@vrufail['vruo'])
                  %td Voted absentee, ballot rejected for other reason
                %tr{:style=>"line-height:10px;"}
                  %td{:colspan=>5} &nbsp;
                %tr
                  %td= number_with_delimiter(@varappr['tot'])
                  %td{:style=>"text-align:right;"}
                    = "&mdash;".html_safe
                  %td Voters whose absentee requests were approved
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varappr['vno'])
                  %td Did not participate
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varappr['vpb'])
                  %td Voted in person
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varappr['vpa'])
                  %td Voted provisionally, ballot accepted
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varappr['vpr'])
                  %td Voted provisionally, ballot rejected
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varappr['vaa'])
                  %td Voted absentee, ballot accepted
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varappr['varl'])
                  %td Voted absentee, ballot rejected as late
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varappr['varo'])
                  %td Voted absentee, ballot rejected for other reason
                %tr{:style=>"line-height:10px;"}
                  %td{:colspan=>5} &nbsp;
                %tr
                  %td= number_with_delimiter(@varfail['tot'])
                  %td{:style=>"text-align:right;"}
                    = "&mdash;".html_safe
                  %td Voters whose absentee requests were ultimately unsuccessful
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varfail['vno'])
                  %td Did not participate
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varfail['vpb'])
                  %td Voted in person
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varfail['vpa'])
                  %td Voted provisionally, ballot accepted
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varfail['vpr'])
                  %td Voted provisionally, ballot rejected
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varfail['vaa'])
                  %td Voted absentee, ballot accepted
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varfail['varl'])
                  %td Voted absentee, ballot rejected as late
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = number_with_delimiter(@varfail['varo'])
                  %td Voted absentee, ballot rejected for other reason
              #likeh4b Demographics
              %table
                %tr
                  %td= number_with_delimiter(@tv)
                  %td{:style=>"text-align:right;"}
                    = "&mdash;".html_safe
                  %td Total voters
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @avotersp[0]
                  %td Male
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @avotersp[1]
                  %td Female
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @avotersp[2]
                  %td Democratic Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @avotersp[3] 
                  %td Republican Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @avotersp[4]
                  %td 3rd Party
                %tr{:style=>"line-height:10px;"}
                  %td{:colspan=>5} &nbsp;
                %tr
                  %td= number_with_delimiter(@vnoruar['tot'])
                  %td{:style=>"text-align:right;"}
                    = "&mdash;".html_safe
                  %td Voters who did not request a record update or absentee ballot
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vnoruarp[0]
                  %td Male
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vnoruarp[1]
                  %td Female
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vnoruarp[2]
                  %td Democratic Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vnoruarp[3] 
                  %td Republican Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vnoruarp[4]
                  %td 3rd Party
                %tr{:style=>"line-height:10px;"}
                  %td{:colspan=>5} &nbsp;
                %tr
                  %td= number_with_delimiter(@vruappr['tot'])
                  %td{:style=>"text-align:right;"}
                    = "&mdash;".html_safe
                  %td Voters whose record update requests were approved
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vruapprp[0]
                  %td Male
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vruapprp[1]
                  %td Female
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vruapprp[2]
                  %td Democratic Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vruapprp[3] 
                  %td Republican Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vruapprp[4]
                  %td 3rd Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vruapprp[5]
                  %td Used online voter services
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vruapprp[6]
                  %td Did not use online voter services
                %tr{:style=>"line-height:10px;"}
                  %td{:colspan=>5} &nbsp;
                %tr
                  %td= number_with_delimiter(@vrufail['tot'])
                  %td{:style=>"text-align:right;"}
                    = "&mdash;".html_safe
                  %td Voters whose record update requests were ultimately unsuccessful
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vrufailp[0]
                  %td Male
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vrufailp[1]
                  %td Female
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vrufailp[2]
                  %td Democratic Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vrufailp[3] 
                  %td Republican Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vrufailp[4]
                  %td 3rd Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vrufailp[5]
                  %td Used online voter services
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @vrufailp[6]
                  %td Did not use online voter services
                %tr{:style=>"line-height:10px;"}
                  %td{:colspan=>5} &nbsp;
                %tr
                  %td= number_with_delimiter(@varappr['tot'])
                  %td{:style=>"text-align:right;"}
                    = "&mdash;".html_safe
                  %td Voters whose absentee requests were approved
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varapprp[0]
                  %td Male
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varapprp[1]
                  %td Female
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varapprp[2]
                  %td Democratic Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varapprp[3] 
                  %td Republican Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varapprp[4]
                  %td 3rd Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varapprp[5]
                  %td Used online voter services
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varapprp[6]
                  %td Did not use online voter services
                %tr{:style=>"line-height:10px;"}
                  %td{:colspan=>5} &nbsp;
                %tr
                  %td= number_with_delimiter(@varfail['tot'])
                  %td{:style=>"text-align:right;"}
                    = "&mdash;".html_safe
                  %td Voters whose absentee requests were ultimately unsuccessful
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varfailp[0]
                  %td Male
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varfailp[1]
                  %td Female
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varfailp[2]
                  %td Democratic Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varfailp[3] 
                  %td Republican Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varfailp[4]
                  %td 3rd Party
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varfailp[5]
                  %td Used online voter services
                %tr
                  %td{:colspan=>2,:style=>"text-align:right;"}
                    = @varfailp[6]
                  %td Did not use online voter services
                %tr{:style=>"line-height:10px;"}
                  %td{:colspan=>5} &nbsp;
          -else
            %p#redelecname
              %br
              ERROR: No Election Selected
